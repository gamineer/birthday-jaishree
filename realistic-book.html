<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Happy Birthday Jaishree - A Memory Novel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap"
    rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Crimson Text', serif;
      background: linear-gradient(135deg, #1a1a1a 0%, #2d1810 50%, #1a1a1a 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      perspective: 1400px;
      overflow: hidden;
    }

    .library-scene {
      position: relative;
      width: 100%;
      max-width: 800px;
      height: 600px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .book-container {
      width: 650px;
      height: 450px;
      position: relative;
      transform-style: preserve-3d;
    }

    .book-spine {
      position: absolute;
      left: -15px;
      top: 10px;
      bottom: 10px;
      width: 30px;
      background: linear-gradient(to right, #3d2914, #5d3d1e, #3d2914);
      border-radius: 5px 0 0 5px;
      box-shadow:
        inset -3px 0 8px rgba(0, 0, 0, 0.4),
        -5px 0 15px rgba(0, 0, 0, 0.3);
      z-index: 1;
    }

    .book-spine::before {
      content: '';
      position: absolute;
      top: 20px;
      left: 2px;
      right: 2px;
      height: 2px;
      background: #d4af37;
      box-shadow: 0 30px 0 #d4af37, 0 60px 0 #d4af37;
    }

    .book-spine::after {
      content: 'JAISHREE';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translateX(-50%) translateY(-50%) rotate(90deg);
      color: #d4af37;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 2px;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }

    .book {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      background: #2d1810;
      border-radius: 0 8px 8px 0;
      box-shadow:
        0 0 0 3px #4a3427,
        0 0 0 6px #2d1810,
        10px 10px 30px rgba(0, 0, 0, 0.5),
        inset 0 0 20px rgba(0, 0, 0, 0.1);
    }

    .page-container {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
    }

    .page-wrapper {
      width: 50%;
      height: 100%;
      position: absolute;
      right: 0;
      top: 0;
      transform-style: preserve-3d;
      transform-origin: left center;
      transition: transform 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      cursor: pointer;
      z-index: 10;
    }

    .page-wrapper.turning {
      transform: rotateY(-185deg);
      z-index: 5;
    }

    .page {
      width: 100%;
      height: 100%;
      position: absolute;
      backface-visibility: hidden;
      border-radius: 0 8px 8px 0;
      box-shadow:
        0 0 10px rgba(0, 0, 0, 0.1),
        inset 2px 0 4px rgba(0, 0, 0, 0.1);
    }

    .page-front {
      background: linear-gradient(135deg, #fefcf8 0%, #f9f6f0 100%);
      z-index: 2;
      border: 1px solid rgba(212, 175, 55, 0.2);
    }

    .page-back {
      background: linear-gradient(135deg, #f7f4ee 0%, #f2efe9 100%);
      transform: rotateY(180deg);
      z-index: 1;
      border: 1px solid rgba(212, 175, 55, 0.2);
    }

    .left-page {
      width: 50%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(135deg, #f7f4ee 0%, #f2efe9 100%);
      border-radius: 8px 0 0 8px;
      border-right: 1px solid #e6e3dd;
      box-shadow:
        inset -2px 0 4px rgba(0, 0, 0, 0.05),
        0 2px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(212, 175, 55, 0.15);
      border-right: 1px solid #e6e3dd;
    }

    .page-content {
      padding: 30px 24px;
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      box-sizing: border-box;
      background: linear-gradient(135deg, #fefcf8 0%, #fbf8f3 100%);
    }

    .page-header {
      text-align: center;
      margin-bottom: 35px;
      border-bottom: 3px solid #d4af37;
      padding-bottom: 18px;
      background: linear-gradient(90deg, transparent 0%, rgba(212, 175, 55, 0.1) 50%, transparent 100%);
      border-radius: 8px 8px 0 0;
    }

    .page-header h1 {
      font-family: 'Playfair Display', serif;
      font-size: 32px;
      font-weight: 700;
      color: #2d1810;
      margin-bottom: 12px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      letter-spacing: 1.5px;
    }

    .page-header .subtitle {
      font-size: 16px;
      color: #8b6914;
      font-style: italic;
      letter-spacing: 1.5px;
      font-weight: 400;
    }

    .story-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      overflow-y: auto;
      overflow-x: hidden;
      min-height: 0;
      padding-right: 5px;
      scrollbar-width: thin;
      scrollbar-color: #d4af37 transparent;
    }

    .story-content::-webkit-scrollbar {
      width: 4px;
    }

    .story-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .story-content::-webkit-scrollbar-thumb {
      background: #d4af37;
      border-radius: 2px;
      opacity: 0.7;
    }

    .story-content::-webkit-scrollbar-thumb:hover {
      background: #ffd700;
      opacity: 1;
    }

    .story-content h2 {
      font-family: 'Playfair Display', serif;
      font-size: 24px;
      font-weight: 700;
      color: #2d1810;
      margin-bottom: 24px;
      text-align: center;
      position: relative;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    .story-content h2::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, transparent 0%, #d4af37 50%, transparent 100%);
      border-radius: 1px;
    }

    .story-text {
      font-size: 17px;
      line-height: 1.9;
      color: #3d2f20;
      text-align: justify;
      text-indent: 32px;
      margin-bottom: 24px;
      letter-spacing: 0.2px;
    }

    .page-number {
      position: absolute;
      bottom: 20px;
      font-size: 14px;
      color: #8b6914;
      font-style: italic;
    }

    .page-number.left {
      left: 35px;
    }

    .page-number.right {
      right: 35px;
    }

    .ornament {
      text-align: center;
      color: #d4af37;
      font-size: 20px;
      margin: 28px 0;
      letter-spacing: 2px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    .controls {
      position: absolute;
      bottom: -80px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
      z-index: 20;
    }

    .nav-btn {
      background: linear-gradient(135deg, #8b4513 0%, #a0522d 100%);
      color: #f9f7f4;
      border: none;
      padding: 15px 25px;
      border-radius: 30px;
      font-size: 16px;
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow:
        0 6px 20px rgba(0, 0, 0, 0.3),
        inset 0 1px 2px rgba(255, 255, 255, 0.2);
      letter-spacing: 0.5px;
      position: relative;
      overflow: hidden;
    }

    .nav-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s;
    }

    .nav-btn:hover::before {
      left: 100%;
    }

    .nav-btn:hover {
      background: linear-gradient(135deg, #a0522d 0%, #cd853f 100%);
      transform: translateY(-3px);
      box-shadow:
        0 8px 25px rgba(0, 0, 0, 0.4),
        inset 0 1px 2px rgba(255, 255, 255, 0.3);
    }

    .nav-btn:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
    }

    .nav-btn:disabled::before {
      display: none;
    }

    .page-indicator {
      position: absolute;
      top: -50px;
      left: 50%;
      transform: translateX(-50%);
      color: #d4af37;
      font-family: 'Playfair Display', serif;
      font-size: 16px;
      font-weight: 600;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Page texture */
    .page-front::before,
    .page-back::before,
    .left-page::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle at 25% 25%, rgba(139, 105, 20, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(139, 105, 20, 0.03) 0%, transparent 50%),
        linear-gradient(45deg, transparent 49%, rgba(139, 105, 20, 0.02) 50%, transparent 51%);
      pointer-events: none;
    }

    @media (max-width: 768px) {
      body {
        padding: 15px;
        perspective: 1000px;
      }

      .library-scene {
        height: 90vh;
        max-width: 100%;
      }

      .book-container {
        width: 95vw;
        height: 65vh;
        max-width: 380px;
        min-height: 280px;
      }

      .book-spine {
        left: -6px;
        width: 12px;
      }

      .book-spine::after {
        font-size: 7px;
        letter-spacing: 0.5px;
      }

      .page-content {
        padding: 18px 12px;
      }

      .page-header {
        margin-bottom: 15px;
        padding-bottom: 8px;
      }

      .page-header h1 {
        font-size: 18px;
        margin-bottom: 6px;
        letter-spacing: 1px;
      }

      .page-header .subtitle {
        font-size: 11px;
        letter-spacing: 1px;
      }

      .story-content h2 {
        font-size: 16px;
        margin-bottom: 12px;
        letter-spacing: 0.5px;
      }

      .story-text {
        font-size: 12px;
        line-height: 1.6;
        margin-bottom: 12px;
        text-indent: 15px;
        letter-spacing: 0.1px;
      }

      .story-text::first-letter {
        font-size: 26px;
        line-height: 22px;
        margin: 1px 6px 0 0;
      }

      .ornament {
        font-size: 13px;
        margin: 10px 0;
        letter-spacing: 1px;
      }

      .page-number {
        font-size: 10px;
        bottom: 12px;
      }

      .page-number.left {
        left: 15px;
      }

      .page-number.right {
        right: 15px;
      }

      .controls {
        bottom: -45px;
        gap: 12px;
      }

      .nav-btn {
        padding: 8px 15px;
        font-size: 12px;
        border-radius: 18px;
      }

      .page-indicator {
        top: -30px;
        font-size: 12px;
      }

      .chapter-indicator {
        top: -50px;
        font-size: 12px;
      }

      .progress-container {
        top: -15px;
        width: 150px;
      }

      /* Improve touch targets */
      .page-wrapper {
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
      }

      /* Optimize 3D transforms for mobile */
      .page-wrapper.turning {
        transform: rotateY(-180deg);
      }

      .control-panel {
        top: 10px;
        right: 10px;
        gap: 8px;
      }

      .control-btn {
        padding: 6px 10px;
        font-size: 12px;
      }
    }

    @media (max-width: 480px) {
      .book-container {
        width: 98vw;
        height: 60vh;
        max-width: 320px;
      }

      .page-content {
        padding: 15px 10px;
      }

      .page-header h1 {
        font-size: 14px;
      }

      .story-content h2 {
        font-size: 12px;
      }

      .story-text {
        font-size: 10px;
        line-height: 1.2;
        text-indent: 10px;
      }

      .story-text::first-letter {
        font-size: 20px;
        line-height: 18px;
      }

      .nav-btn {
        padding: 6px 12px;
        font-size: 11px;
        gap: 8px;
      }

      .controls {
        bottom: -35px;
      }

      .ornament {
        font-size: 10px;
        margin: 4px 0;
      }
    }

    /* Touch gesture improvements */
    @media (hover: none) and (pointer: coarse) {
      .page-wrapper {
        touch-action: manipulation;
        transition: opacity 0.15s ease;
      }

      .nav-btn:hover {
        background: linear-gradient(135deg, #8b4513 0%, #a0522d 100%);
        transform: none;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      .nav-btn:active {
        background: linear-gradient(135deg, #a0522d 0%, #cd853f 100%);
        transform: scale(0.95);
      }
    }

    /* Loading animation */
    .book-container {
      opacity: 0;
      animation: bookAppear 1s ease-out 0.5s forwards;
    }

    @keyframes bookAppear {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(20px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    /* Mobile-friendly help text */
    .mobile-hint {
      position: absolute;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      color: #d4af37;
      font-size: 12px;
      text-align: center;
      opacity: 0.8;
      font-style: italic;
    }

    @media (min-width: 769px) {
      .mobile-hint {
        display: none;
      }
    }

    /* New Feature Styles */
    :root {
      --text-color: #3d2f20;
      --accent-color: #d4af37;
      --page-bg: #fefcf8;
    }

    /* Progress Bar */
    .progress-container {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 4px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #d4af37, #ffd700);
      border-radius: 2px;
      width: 0%;
      transition: width 0.6s ease;
    }

    /* Chapter Indicator */
    .chapter-indicator {
      position: absolute;
      top: -70px;
      left: 50%;
      transform: translateX(-50%);
      color: #d4af37;
      font-family: 'Playfair Display', serif;
      font-size: 14px;
      font-weight: 600;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Control Panel */
    .control-panel {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 10px;
      z-index: 100;
    }

    .control-btn {
      background: rgba(139, 69, 19, 0.8);
      color: #f9f7f4;
      border: none;
      padding: 8px 12px;
      border-radius: 15px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .control-btn:hover {
      background: rgba(139, 69, 19, 1);
      transform: translateY(-2px);
    }

    /* Floating Quote Animation */
    @keyframes floating-quote {
      0% {
        opacity: 0;
        transform: translateX(-50%) translateY(20px) scale(0.8);
      }

      20% {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
      }

      80% {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
      }

      100% {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px) scale(0.8);
      }
    }

    /* Confetti Animation */
    @keyframes confetti-fall {
      from {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 1;
      }

      to {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* Parallax Effects */
    .parallax-element {
      position: absolute;
      opacity: 0.1;
      pointer-events: none;
      transition: transform 0.1s ease-out;
    }

    .star {
      color: #d4af37;
      font-size: 20px;
    }

    .star-1 {
      top: 10%;
      left: 10%;
    }

    .star-2 {
      top: 20%;
      right: 15%;
    }

    .star-3 {
      bottom: 30%;
      left: 20%;
    }

    .star-4 {
      bottom: 10%;
      right: 10%;
    }

    /* Interactive Elements */
    .clickable-word {
      cursor: pointer;
      position: relative;
      transition: color 0.3s ease;
    }

    .clickable-word:hover {
      color: #d4af37;
      text-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
    }

    /* Accessibility Improvements */
    .nav-btn:focus,
    .control-btn:focus {
      outline: 3px solid #d4af37;
      outline-offset: 2px;
    }

    /* Screen Reader Only */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* Scroll Indicator */
    .scroll-indicator {
      position: absolute;
      bottom: 18px;
      right: 20px;
      color: rgba(212, 175, 55, 0.9);
      font-size: 11px;
      background: rgba(255, 255, 255, 0.95);
      padding: 6px 10px;
      border-radius: 15px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(212, 175, 55, 0.3);
      opacity: 0.8;
      animation: scroll-pulse 2s infinite;
      pointer-events: none;
      font-weight: 500;
    }

    @keyframes scroll-pulse {

      0%,
      100% {
        opacity: 0.8;
        transform: translateY(0);
      }

      50% {
        opacity: 1;
        transform: translateY(-2px);
      }
    }

    .scroll-indicator.hidden {
      display: none;
    }
  </style>
</head>

<body>
  <!-- Control Panel -->
  <div class="control-panel">
    <button class="control-btn" onclick="shareMemory()" title="Share Memory">
      üì±
    </button>
    <button class="control-btn" onclick="createConfetti()" title="Celebrate">
      üéâ
    </button>
    <button class="control-btn" onclick="adjustTextSize()" title="Adjust Text Size">
      üî§
    </button>
  </div>

  <!-- Parallax Stars -->
  <div class="parallax-element star star-1">‚ú®</div>
  <div class="parallax-element star star-2">‚≠ê</div>
  <div class="parallax-element star star-3">‚ú®</div>
  <div class="parallax-element star star-4">‚≠ê</div>

  <div class="library-scene">
    <div class="book-container">
      <div class="book-spine"></div>
      <div class="book">
        <div class="page-container">
          <!-- Left static page -->
          <div class="left-page">
            <div class="page-content">
              <div id="left-content">
                <!-- Content will be populated by JavaScript -->
              </div>
              <div class="page-number left" id="left-page-number">1</div>
              <div class="scroll-indicator" id="left-scroll-indicator">‚¨áÔ∏è Scroll</div>
            </div>
          </div>

          <!-- Right flipping page -->
          <div class="page-wrapper" id="pageWrapper">
            <div class="page page-front">
              <div class="page-content">
                <div id="right-content">
                  <!-- Content will be populated by JavaScript -->
                </div>
                <div class="page-number right" id="right-page-number">2</div>
                <div class="scroll-indicator" id="right-scroll-indicator">‚¨áÔ∏è Scroll</div>
              </div>
            </div>
            <div class="page page-back">
              <div class="page-content">
                <div id="back-content">
                  <!-- Back of the page content -->
                </div>
                <div class="page-number left" id="back-page-number">3</div>
              </div>
            </div>
          </div>
        </div>

        <div class="progress-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>

        <div class="chapter-indicator" id="chapterIndicator">
          Chapter 1 of 6
        </div>

        <div class="page-indicator">
          <span id="current-spread">Page 1-2</span> of <span id="total-pages">12</span>
        </div>
        <div class="controls">
          <button class="nav-btn" id="prevBtn" onclick="previousPage()">
            ‚óÄ Previous
          </button>
          <button class="nav-btn" id="nextBtn" onclick="handleNextBtnClick()">
            Next ‚ñ∂
          </button>
          <script>
            // ...existing code...
            // Patch: Change Next button text on last page and show voice note overlay
            function handleNextBtnClick() {
              if (currentSpread === bookContent.length - 1) {
                showVoiceNoteOverlay();
              } else {
                nextPage();
              }
            }

            // Update Next button text on last spread
            function updateNextBtnText() {
              const nextBtn = document.getElementById('nextBtn');
              if (currentSpread === bookContent.length - 1) {
                nextBtn.textContent = 'Click here for final gift';
              } else {
                nextBtn.textContent = 'Next ‚ñ∂';
              }
            }

            // Call updateNextBtnText whenever content changes
            const origUpdateContent = updateContent;
            updateContent = function () {
              origUpdateContent();
              updateNextBtnText();
            };

            // Voice note overlay UI (same as treasure hunt)
            function showVoiceNoteOverlay() {
              // Hide book container
              document.querySelector('.library-scene').style.display = 'none';

              // Create overlay
              const overlay = document.createElement('div');
              overlay.id = 'voiceNoteOverlay';
              overlay.style.position = 'fixed';
              overlay.style.top = '0';
              overlay.style.left = '0';
              overlay.style.width = '100vw';
              overlay.style.height = '100vh';
              overlay.style.background = 'linear-gradient(120deg, #f8e8ff 0%, #e0f7fa 100%)';
              overlay.style.display = 'flex';
              overlay.style.flexDirection = 'column';
              overlay.style.alignItems = 'center';
              overlay.style.justifyContent = 'center';
              overlay.style.zIndex = '9999';

              // Caring message
              const msg = document.createElement('div');
              msg.innerHTML = `<h2 style="font-family:'Playfair Display',serif;color:#a77cff;font-size:1.5em;margin-bottom:10px;">A Special Voice Note for You</h2>
        <div style="color:#7a5fa4;font-family:'Crimson Text',serif;font-size:1.1em;margin-bottom:24px;text-align:center;max-width:340px;">Before you go, listen to this message made just for you. Close your eyes, smile, and feel the magic! üíú</div>`;
              overlay.appendChild(msg);

              // Voice note player UI
              const player = document.createElement('div');
              player.style.display = 'flex';
              player.style.flexDirection = 'column';
              player.style.alignItems = 'center';
              player.style.justifyContent = 'center';
              player.style.background = 'rgba(255,255,255,0.95)';
              player.style.borderRadius = '22px';
              player.style.boxShadow = '0 4px 24px #b47cff33';
              player.style.padding = '32px 24px 24px 24px';
              player.style.marginBottom = '24px';
              player.style.maxWidth = '340px';
              player.style.width = '90vw';

              // Play button
              const playBtn = document.createElement('button');
              playBtn.id = 'playVoiceBtn';
              playBtn.innerHTML = `<svg width="48" height="48" viewBox="0 0 48 48"><circle cx="24" cy="24" r="24" fill="#a77cff"/><polygon points="19,15 36,24 19,33" fill="#fff"/></svg>`;
              playBtn.style.background = 'none';
              playBtn.style.border = 'none';
              playBtn.style.cursor = 'pointer';
              playBtn.style.marginBottom = '18px';
              playBtn.style.transition = 'transform 0.2s';
              playBtn.onpointerdown = () => playBtn.style.transform = 'scale(0.95)';
              playBtn.onpointerup = () => playBtn.style.transform = 'scale(1)';
              player.appendChild(playBtn);

              // Waveform animation
              const waveform = document.createElement('div');
              waveform.id = 'voiceWaveform';
              waveform.style.display = 'flex';
              waveform.style.gap = '3px';
              waveform.style.justifyContent = 'center';
              waveform.style.alignItems = 'end';
              waveform.style.height = '32px';
              waveform.style.marginBottom = '10px';
              for (let i = 0; i < 16; i++) {
                const bar = document.createElement('div');
                bar.style.width = '6px';
                bar.style.height = (8 + Math.random() * 24) + 'px';
                bar.style.background = '#a77cff';
                bar.style.borderRadius = '3px';
                bar.style.transition = 'height 0.2s';
                waveform.appendChild(bar);
              }
              player.appendChild(waveform);

              // Audio element (replace src with your actual voice note file)
              const audio = document.createElement('audio');
              audio.id = 'voiceAudio';
              audio.src = 'voice-note-jaishree.mp3'; // Place your file in the same folder
              audio.preload = 'auto';
              player.appendChild(audio);

              // Play logic and waveform animation
              let animInterval = null;
              playBtn.onclick = function () {
                if (audio.paused) {
                  audio.play();
                } else {
                  audio.pause();
                }
              };
              audio.onplay = function () {
                playBtn.innerHTML = `<svg width="48" height="48" viewBox="0 0 48 48"><circle cx="24" cy="24" r="24" fill="#a77cff"/><rect x="16" y="15" width="6" height="18" rx="2" fill="#fff"/><rect x="26" y="15" width="6" height="18" rx="2" fill="#fff"/></svg>`;
                animInterval = setInterval(() => {
                  Array.from(waveform.children).forEach(bar => {
                    bar.style.height = (8 + Math.random() * 24) + 'px';
                  });
                }, 120);
              };
              audio.onpause = audio.onended = function () {
                playBtn.innerHTML = `<svg width="48" height="48" viewBox="0 0 48 48"><circle cx="24" cy="24" r="24" fill="#a77cff"/><polygon points="19,15 36,24 19,33" fill="#fff"/></svg>`;
                clearInterval(animInterval);
                Array.from(waveform.children).forEach(bar => {
                  bar.style.height = '12px';
                });
              };

              overlay.appendChild(player);

              // Finish button
              const finishBtn = document.createElement('button');
              finishBtn.textContent = 'Finish';
              finishBtn.style.background = 'linear-gradient(90deg, #a77cff 0%, #ffd6e0 100%)';
              finishBtn.style.color = '#fff';
              finishBtn.style.border = 'none';
              finishBtn.style.borderRadius = '14px';
              finishBtn.style.fontSize = '1.1em';
              finishBtn.style.fontFamily = "'Playfair Display', serif";
              finishBtn.style.fontWeight = '700';
              finishBtn.style.padding = '16px 0';
              finishBtn.style.width = '90vw';
              finishBtn.style.maxWidth = '320px';
              finishBtn.style.margin = '0 auto';
              finishBtn.style.marginTop = '12px';
              finishBtn.style.boxShadow = '0 2px 12px #b47cff22';
              finishBtn.style.transition = 'background 0.3s, box-shadow 0.3s, transform 0.2s';
              finishBtn.onpointerdown = () => finishBtn.style.transform = 'scale(0.97)';
              finishBtn.onpointerup = () => finishBtn.style.transform = 'scale(1)';
              finishBtn.onclick = function () {
                audio.pause();
                window.location.href = 'index.html';
              };
              overlay.appendChild(finishBtn);

              document.body.appendChild(overlay);
            }
          </script>
        </div>

        <div class="mobile-hint">
          üì± Swipe left/right or tap buttons to turn pages
        </div>
      </div>
    </div>
  </div>

  <script>
    // Audio System
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    function createPageTurnSound() {
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();

      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);

      oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
      oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.1);

      gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);

      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + 0.1);
    }

    // Confetti System
    function createConfetti() {
      const colors = ['#d4af37', '#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1'];
      const confettiContainer = document.createElement('div');
      confettiContainer.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1000;
            `;
      document.body.appendChild(confettiContainer);

      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.style.cssText = `
                    position: absolute;
                    width: 10px;
                    height: 10px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    top: -10px;
                    left: ${Math.random() * 100}%;
                    animation: confetti-fall ${2 + Math.random() * 3}s linear forwards;
                    border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                `;
        confettiContainer.appendChild(confetti);
      }

      setTimeout(() => {
        document.body.removeChild(confettiContainer);
      }, 5000);
    }

    // Social Sharing
    function shareMemory() {
      if (navigator.share) {
        navigator.share({
          title: 'Happy Birthday Jaishree!',
          text: 'Check out this beautiful birthday memory book for Jaishree!',
          url: window.location.href
        });
      } else {
        // Fallback for browsers without Web Share API
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent('Happy Birthday Jaishree! Check out this beautiful memory book!');
        window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
      }
    }

    // Easter Eggs System
    const easterEggs = {
      'bollywood': () => {
        showFloatingQuote("Kuch kuch hota hai... Happy Birthday! üé¨");
        createConfetti();
      },
      'jaishree': () => {
        showFloatingQuote("You're the star of this story! ‚≠ê");
      },
      'birthday': () => {
        createConfetti();
        showFloatingQuote("Janamdin Mubarak Ho! üéÇ");
      }
    };

    function showFloatingQuote(quote) {
      const floatingQuote = document.createElement('div');
      floatingQuote.textContent = quote;
      floatingQuote.style.cssText = `
                position: fixed;
                top: 20%;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(212, 175, 55, 0.9);
                color: white;
                padding: 15px 25px;
                border-radius: 25px;
                font-family: 'Playfair Display', serif;
                font-size: 18px;
                font-weight: 600;
                z-index: 1000;
                animation: floating-quote 3s ease-in-out forwards;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            `;
      document.body.appendChild(floatingQuote);

      setTimeout(() => {
        if (document.body.contains(floatingQuote)) {
          document.body.removeChild(floatingQuote);
        }
      }, 3000);
    }

    // Progress System
    function updateProgress() {
      const progress = ((currentSpread + 1) / bookContent.length) * 100;
      const progressBar = document.getElementById('progressBar');
      if (progressBar) {
        progressBar.style.width = progress + '%';
      }

      const chapterIndicator = document.getElementById('chapterIndicator');
      if (chapterIndicator) {
        chapterIndicator.textContent = `Chapter ${currentSpread + 1} of ${bookContent.length}`;
      }
    }

    // Text Size Control
    let textSizeLevel = 1; // 0 = small, 1 = medium, 2 = large
    const textSizes = ['small', 'medium', 'large'];

    function adjustTextSize() {
      textSizeLevel = (textSizeLevel + 1) % 3;
      const sizeName = textSizes[textSizeLevel];

      // Apply text size to all story content
      const storyTexts = document.querySelectorAll('.story-text');
      const storyTitles = document.querySelectorAll('.story-content h2');
      const pageHeaders = document.querySelectorAll('.page-header h1');

      storyTexts.forEach(text => {
        switch (textSizeLevel) {
          case 0: // Small
            text.style.fontSize = '10px';
            text.style.lineHeight = '1.3';
            break;
          case 1: // Medium
            text.style.fontSize = '11px';
            text.style.lineHeight = '1.4';
            break;
          case 2: // Large
            text.style.fontSize = '12px';
            text.style.lineHeight = '1.5';
            break;
        }
      });

      storyTitles.forEach(title => {
        switch (textSizeLevel) {
          case 0:
            title.style.fontSize = '13px';
            break;
          case 1:
            title.style.fontSize = '15px';
            break;
          case 2:
            title.style.fontSize = '16px';
            break;
        }
      });

      pageHeaders.forEach(header => {
        switch (textSizeLevel) {
          case 0:
            header.style.fontSize = '18px';
            break;
          case 1:
            header.style.fontSize = '20px';
            break;
          case 2:
            header.style.fontSize = '22px';
            break;
        }
      });

      showFloatingQuote(`Text size: ${sizeName.toUpperCase()} üìñ`);
    }

    // Smooth scrolling for page content
    function smoothScrollToTop(element) {
      if (element.scrollTop > 0) {
        element.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      }
    }
    // Book content - each spread contains left and right page content
    const bookContent = [
      // Cover
      {
        left: {
          type: 'cover',
          title: 'Pages Between Us',
          subtitle: 'A Novel for Jaishree',
          content: `
            <div class="page-header">
              <h1>Pages Between Us</h1>
              <div class="subtitle">A Novel for Jaishree</div>
            </div>
            <div class="story-content">
              <div class="ornament">‚ú® ‚ùÄ ‚ú®</div>
              <div class="story-text" style="text-align: center; text-indent: 0;">
                <em>For Jaishree Mundada<br>With love, memories, and hope for the future.<br><br>Happy Birthday!</em>
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <h2>Index</h2>
              <div class="story-text" style="text-align:left;">
                <ol style="padding-left:1.2em;">
                  <li>Chapter 1: The First Call</li>
                  <li>Chapter 2: The Night of Dancing</li>
                  <li>Chapter 3: The Train Chats</li>
                  <li>Chapter 4: Opposites Attract</li>
                  <li>Chapter 5: Summer & Goodbyes</li>
                  <li>Chapter 6: Two Days of Home</li>
                  <li>Chapter 7: The Pressures of Life</li>
                  <li>Chapter 8: Silence</li>
                  <li>Chapter 9: The Call That Changed It</li>
                  <li>Chapter 10: The Present & The Future</li>
                </ol>
              </div>
            </div>
          `
        }
      },
      // Chapter 1
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 1: The First Call</h2>
              <div class="story-text">
                I knew of you,<br>
                but never knew you.<br>
                One ordinary day,<br>
                a WhatsApp ring bridged that silence.<br>
                We spoke‚Äî<br>
                a first meeting through pixels and sound,
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                yet it felt strangely real.<br>
                The first line of our story<br>
                was written there.
              </div>
            </div>
          `
        }
      },
      // Chapter 2
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 2: The Night of Dancing</h2>
              <div class="story-text">
                December 31st.<br>
                Music, laughter, friends all around.<br>
                But my eyes stayed on you.<br>
                You danced like you owned the floor,<br>
                like rhythm itself had chosen you.<br>
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                Later, dinner together‚Äî<br>
                conversations and smiles,<br>
                our friends still near,<br>
                yet a memory carved just for me.<br>
                That night glows still,<br>
                a lantern in my heart.
              </div>
            </div>
          `
        }
      },
      // Chapter 3
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 3: The Train Chats</h2>
              <div class="story-text">
                The new year began with distance.<br>
                I boarded a train,<br>
                but in truth, it was not a train ride‚Äî<br>
                it was a conversation.<br>
                An hour,<br>
                then two,<br>
                then five,<br>
                time slipped unnoticed.
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                From that day,<br>
                our chats became a ritual,<br>
                a gentle habit woven into life.
              </div>
            </div>
          `
        }
      },
      // Chapter 4
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 4: Opposites Attract</h2>
              <div class="story-text">
                We discovered we were opposites‚Äî<br>
                two sides of a spectrum.<br>
                Yet somehow,<br>
                that difference created balance.<br>
                Exams came,<br>
                college called,<br>
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                but even in chaos,<br>
                a thought lingered:<br>
                ‚ÄúI need to text her.‚Äù<br>
                Slowly,<br>
                you became part of my everyday.
              </div>
            </div>
          `
        }
      },
      // Chapter 5
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 5: Summer & Goodbyes</h2>
              <div class="story-text">
                Summer arrived with change.<br>
                You had exams,<br>
                I had an internship.<br>
                Before I left,<br>
                you came to meet me‚Äî<br>
                not alone, but still,<br>
                it mattered.<br>
                That moment etched itself in me:<br>
                a gesture,<br>
                a kindness,
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                a memory I carried forward.<br>
                Then came silence,<br>
                distance,<br>
                a gap we hoped time would heal.
              </div>
            </div>
          `
        }
      },
      // Chapter 6
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 6: Two Days of Home</h2>
              <div class="story-text">
                Back home, but only for two days.<br>
                I was desperate to see you‚Äî<br>
                and I did.<br>
                An evening together,<br>
                face to face, not through a screen.<br>
                Different.<br>
                Real.
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                A chance to know you more,<br>
                to feel presence instead of pixels.<br>
                That evening stays with me,<br>
                quiet and precious.
              </div>
            </div>
          `
        }
      },
      // Chapter 7
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 7: The Pressures of Life</h2>
              <div class="story-text">
                Life sped up.<br>
                You with internships,<br>
                me with placements.<br>
                Schedules clashed,<br>
                calls faded.<br>
                But when I stood on a national stage,<br>
                you were there in spirit‚Äî<br>
                my supporter,
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                my motivator.<br>
                I am grateful still,<br>
                for the strength you lent me<br>
                without even knowing.
              </div>
            </div>
          `
        }
      },
      // Chapter 8
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 8: Silence</h2>
              <div class="story-text">
                And then‚Äî<br>
                the silence.<br>
                The rhythm broke,<br>
                messages slowed,<br>
                and finally stopped.<br>
                At first, it hurt.<br>
                A missing piece in my routine,
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                an emptiness where words used to be.<br>
                But I realized:<br>
                perhaps we were not<br>
                on the same page.<br>
                Sometimes,<br>
                stepping back<br>
                is the only way to honor a bond.
              </div>
            </div>
          `
        }
      },
      // Chapter 9
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 9: The Call That Changed It</h2>
              <div class="story-text">
                Twenty days passed,<br>
                then a group video call‚Äî<br>
                a gathering of three.<br>
                When it ended,<br>
                I could not hold back.<br>
                I texted you.
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                And just like that,<br>
                the silence cracked.<br>
                Not what it once was,<br>
                but something.<br>
                Enough to remind me<br>
                that connection still lived.
              </div>
            </div>
          `
        }
      },
      // Chapter 10
      {
        left: {
          content: `
            <div class="story-content">
              <h2>Chapter 10: The Present & The Future</h2>
              <div class="story-text">
                Now,<br>
                life keeps pulling us in different directions.<br>
                Schedules don‚Äôt align,<br>
                calls get missed.<br>
                But still,<br>
                I try.<br>
                I stay updated,<br>
                I reach out,
              </div>
            </div>
          `
        },
        right: {
          content: `
            <div class="story-content">
              <div class="story-text">
                I hold onto the thread.<br>
                Because you are dear to me,<br>
                because I believe:<br>
                this too shall pass.<br>
                One day,<br>
                we‚Äôll overcome the distance.<br>
                One day,<br>
                we‚Äôll find our rhythm again.
              </div>
            </div>
            <div class="story-content" style="margin-top:2em;">
              <div class="ornament">üéÅ</div>
              <div class="story-text" style="text-align:center;">This is the final gift.</div>
            </div>
          `
        }
      },
      // Back Cover
      {
        left: {
          content: `
            <div class="story-content">
              <h2>The End... or Beginning?</h2>
              <div class="story-text">
                As this little novel comes to a close, remember that every ending is just a new beginning.<br>
                This birthday marks not just another year, but another chapter in your amazing story.
              </div>
              <div class="ornament">üìñ ‚ú® üìñ</div>
              <div class="story-text" style="text-align: center; text-indent: 0;">
                May your story continue to inspire<br>
                and your journey be filled with joy!
              </div>
            </div>
          `
        },
        right: {
          type: 'back-cover',
          content: `
            <div class="page-header">
              <h1>Until We Meet Again</h1>
              <div class="subtitle">A Friendship Novel</div>
            </div>
            <div class="story-content">
              <div class="ornament">üé≠ ‚öñÔ∏è üé¨</div>
              <div class="story-text" style="text-align: center; text-indent: 0;">
                <em>"The best birthdays are the ones<br>
                that remind us how much<br>
                we are loved and appreciated."</em><br><br>
                <strong>Happy Birthday, Jaishree!</strong><br>
                May your year ahead be filled with<br>
                love, laughter, and all your heart desires.
              </div>
            </div>
          `
        }
      }
    ];

    let currentSpread = 0;
    let isFlipping = false;

    function updateContent() {
      const spread = bookContent[currentSpread];

      // Update left page
      document.getElementById('left-content').innerHTML = spread.left.content;
      document.getElementById('left-page-number').textContent = (currentSpread * 2 + 1);

      // Update right page
      document.getElementById('right-content').innerHTML = spread.right.content;
      document.getElementById('right-page-number').textContent = (currentSpread * 2 + 2);

      // Update back page (for next spread)
      if (currentSpread < bookContent.length - 1) {
        const nextSpread = bookContent[currentSpread + 1];
        document.getElementById('back-content').innerHTML = nextSpread.left.content;
        document.getElementById('back-page-number').textContent = ((currentSpread + 1) * 2 + 1);
      } else {
        document.getElementById('back-content').innerHTML = '<div class="story-content"><div class="ornament">~ The End ~</div></div>';
        document.getElementById('back-page-number').textContent = '';
      }

      // Update page indicator
      document.getElementById('current-spread').textContent = `Page ${currentSpread * 2 + 1}-${currentSpread * 2 + 2}`;
      document.getElementById('total-pages').textContent = bookContent.length * 2;

      // Update button states
      document.getElementById('prevBtn').disabled = currentSpread === 0;
      document.getElementById('nextBtn').disabled = currentSpread === bookContent.length - 1;

      // Update progress and chapter indicators
      updateProgress();

      // Add screen reader announcements
      const announcement = `Now on chapter ${currentSpread + 1} of ${bookContent.length}`;
      announceToScreenReader(announcement);

      // Refresh scroll indicators for new content
      setTimeout(() => {
        initializeScrollIndicators();
      }, 100);
    }

    function nextPage() {
      if (isFlipping || currentSpread >= bookContent.length - 1) return;

      // Play page turn sound
      try {
        createPageTurnSound();
      } catch (e) {
        console.log('Audio not available');
      }

      isFlipping = true;
      const pageWrapper = document.getElementById('pageWrapper');
      pageWrapper.classList.add('turning');

      // Trigger confetti on birthday page
      if (currentSpread === 3) { // Birthday wishes page
        setTimeout(() => createConfetti(), 300);
      }

      setTimeout(() => {
        currentSpread++;
        updateContent();

        // Scroll all story content to top
        document.querySelectorAll('.story-content').forEach(content => {
          smoothScrollToTop(content);
        });

        pageWrapper.classList.remove('turning');
        isFlipping = false;
      }, 600); // Mid-animation
    }

    function previousPage() {
      if (isFlipping || currentSpread <= 0) return;

      // Play page turn sound
      try {
        createPageTurnSound();
      } catch (e) {
        console.log('Audio not available');
      }

      isFlipping = true;
      currentSpread--;
      updateContent();

      const pageWrapper = document.getElementById('pageWrapper');
      pageWrapper.classList.add('turning');

      setTimeout(() => {
        // Scroll all story content to top
        document.querySelectorAll('.story-content').forEach(content => {
          smoothScrollToTop(content);
        });

        pageWrapper.classList.remove('turning');
        isFlipping = false;
      }, 1200);
    }    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight' || e.key === ' ') {
        e.preventDefault();
        nextPage();
      } else if (e.key === 'ArrowLeft') {
        e.preventDefault();
        previousPage();
      }
    });

    // Touch/Swipe gestures for mobile
    let touchStartX = 0;
    let touchStartY = 0;
    let touchEndX = 0;
    let touchEndY = 0;

    const bookContainer = document.querySelector('.book-container');

    bookContainer.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
      touchStartY = e.changedTouches[0].screenY;
    }, { passive: true });

    bookContainer.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      touchEndY = e.changedTouches[0].screenY;
      handleSwipe();
    }, { passive: true });

    function handleSwipe() {
      const deltaX = touchEndX - touchStartX;
      const deltaY = touchEndY - touchStartY;
      const minSwipeDistance = 50;

      // Check if horizontal swipe is more significant than vertical
      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
        if (deltaX > 0) {
          // Swipe right - go to previous page
          previousPage();
        } else {
          // Swipe left - go to next page
          nextPage();
        }
      }
    }

    // Click to turn page (for desktop and mobile tap)
    document.getElementById('pageWrapper').addEventListener('click', (e) => {
      // Only trigger if not swiping
      if (Math.abs(touchEndX - touchStartX) < 30) {
        nextPage();
      }
    });

    // Prevent context menu on long press for mobile
    bookContainer.addEventListener('contextmenu', (e) => {
      e.preventDefault();
    });

    // Add visual feedback for mobile interactions
    const pageWrapper = document.getElementById('pageWrapper');
    let touchTimeout;

    pageWrapper.addEventListener('touchstart', () => {
      pageWrapper.style.opacity = '0.8';
      touchTimeout = setTimeout(() => {
        pageWrapper.style.opacity = '1';
      }, 150);
    });

    pageWrapper.addEventListener('touchend', () => {
      clearTimeout(touchTimeout);
      pageWrapper.style.opacity = '1';
    });

    // Accessibility function
    function announceToScreenReader(message) {
      const announcement = document.createElement('div');
      announcement.setAttribute('aria-live', 'polite');
      announcement.setAttribute('aria-atomic', 'true');
      announcement.className = 'sr-only';
      announcement.textContent = message;
      document.body.appendChild(announcement);

      setTimeout(() => {
        if (document.body.contains(announcement)) {
          document.body.removeChild(announcement);
        }
      }, 1000);
    }

    // Parallax effect for stars
    function updateParallax(e) {
      const stars = document.querySelectorAll('.parallax-element');
      const x = e.clientX / window.innerWidth;
      const y = e.clientY / window.innerHeight;

      stars.forEach((star, index) => {
        const speed = (index + 1) * 10;
        const xOffset = (x - 0.5) * speed;
        const yOffset = (y - 0.5) * speed;
        star.style.transform = `translate(${xOffset}px, ${yOffset}px)`;
      });
    }

    function initializeScrollIndicators() {
      const leftContent = document.getElementById('left-content');
      const rightContent = document.getElementById('right-content');
      const leftIndicator = document.getElementById('left-scroll-indicator');
      const rightIndicator = document.getElementById('right-scroll-indicator');

      function checkScrollable(element, indicator) {
        if (element && indicator) {
          const isScrollable = element.scrollHeight > element.clientHeight;
          indicator.style.display = isScrollable ? 'block' : 'none';

          if (isScrollable) {
            element.addEventListener('scroll', function () {
              const isAtBottom = element.scrollTop + element.clientHeight >= element.scrollHeight - 5;
              indicator.style.opacity = isAtBottom ? '0.3' : '1';
            });
          }
        }
      }

      // Check both pages
      setTimeout(() => {
        checkScrollable(leftContent, leftIndicator);
        checkScrollable(rightContent, rightIndicator);
      }, 100);
    }

    // Initialize all systems
    function initializeBook() {
      // Add parallax listener
      document.addEventListener('mousemove', updateParallax);

      // Add ARIA labels for better accessibility
      document.getElementById('prevBtn').setAttribute('aria-label', 'Go to previous page');
      document.getElementById('nextBtn').setAttribute('aria-label', 'Go to next page');
      document.querySelector('.book-container').setAttribute('role', 'main');
      document.querySelector('.book-container').setAttribute('aria-label', 'Birthday memory book for Jaishree');

      // Welcome message
      setTimeout(() => {
        showFloatingQuote("Welcome to Jaishree's Birthday Story! üìñ‚ú®");
      }, 2000);

      // Update initial content
      updateContent();

      // Initialize scroll indicators
      initializeScrollIndicators();
    }

    // Initialize
    initializeBook();
  </script>
</body>

</html>